
<!-- saved from url=(0113)file:///E:/Study/CS%20193A%20-%20Android/CS193A-master/Winter2017Update/class/cs193a/lectures/slides/login.html#/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
		<title>CS 193A - User Login</title>
		<link rel="stylesheet" href="./CS 193A - User Login_files/default.css" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/highlightjs/styles/default.css">
		<link rel="stylesheet" href="./CS 193A - User Login_files/reveal.css" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/reveal/css/reveal.css">
		<link rel="stylesheet" href="./CS 193A - User Login_files/white.css" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/reveal/css/theme/white.css">
		<link rel="stylesheet" href="./CS 193A - User Login_files/cs193a-slides.css" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/cs193a-slides.css">
	</head>
	<body>
		<div class="reveal slide" role="application" data-transition-speed="default" data-background-transition="fade">
			<div class="slides" style="width: 960px; height: 700px; left: 50%; top: 50%; bottom: auto; right: auto; transform: translate(-50%, -50%) scale(0.796643);">

<!-- BEGIN SLIDES AREA -->

<section class="titleslide present" style="display: block;">
	<h1>CS 193A</h1>

	<p>User Login</p>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: block;">
	<h1>Authentication</h1>
	
	<p>
		Most modern apps require the user to have an <strong>account</strong> or <strong>log in</strong>.
	</p>
	
	<div class="figuresright">
		<img src="./CS 193A - User Login_files/authentication.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/authentication.png" alt="figure">
	</div>
	
	<ul>
		<li><strong>authentication:</strong> Logging in / verifying identity of a user.
			<ul>
				<li>"Who is this user?"
			</li></ul>
		
		</li><li><strong>authorization:</strong> Granting / denying permissions for various actions.
			<ul>
				<li>"What is this user allowed to do?"
			</li></ul>
		
		</li><li>many ways to do this:
			<ul>
				
			</ul>
	</li></ul>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: block;">
	<h1>How to do Authentication</h1>
	
	<div class="figuresright">
		<img src="./CS 193A - User Login_files/sign-in-with-google.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/sign-in-with-google.png" alt="figure">
	</div>
	
	<ul>
		<li><strong>do it yourself:</strong> Write code to ask for a user name/password.
			<ul>
				<li>hard to get this right!
				</li><li>must encrypt user data securely in database
				</li><li>must use secure protocols, HTTPS, etc.
				</li><li>if server hacked, users get mad
				</li><li><strong>Do not do this.</strong>
			</li></ul>
		</li><li><strong>use an external auth service:</strong> Rely on an outside entity for auth.
			<ul>
				<li>Google account, Facebook, Microsoft, GitHub, PayPal, ...
					<ul>
						<li>+: easier
						</li><li>-: introduces a dependency; requires users to have an account on that service
					</li></ul>
			</li></ul>
	</li></ul>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Google Identity Platform</h1>
	
	<div class="figuresright">
		<img src="./CS 193A - User Login_files/sign-in-button.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/sign-in-button.png" alt="figure">
		<img src="./CS 193A - User Login_files/oauth.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/oauth.png" alt="figure">
	</div>
	
	<ul>
		<li><strong>Google Identity Platform:</strong>
			Services provided by Google to help integrate accounts and login into apps.
			<ul>
				<li>sometimes just called "Google Sign-in"
				</li><li>built on top of OAuth
			</li></ul>
		
		</li><li><strong><a class="popup" href="javascript:if(confirm(%27https://oauth.net/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://oauth.net/%27" tppabs="https://oauth.net/" target="_blank">OAuth:</a></strong> Open standard for authorization features.
			<ul>
				<li>current version: <strong>OAuth 2.0</strong>
			</li></ul>
	</li></ul>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Preparing your emulator</h1>
	
	<ul>
		<li>to use Google Sign-in, must install <strong>Google Play Services</strong> in emulator
		</li><li>in A.Studio:  "<strong>SDK Manager</strong>"
			<img class="icon" src="./CS 193A - User Login_files/sdk-manager-toolbar-icon.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/sdk-manager-toolbar-icon.png" alt="figure" title="SDK Manager">
			<ul>
				<li>make sure "<strong>Google APIs</strong>" are installed
			</li></ul>
		</li><li>in A.Studio: "<strong>AVD Manager</strong>"
			<img class="icon" src="./CS 193A - User Login_files/avd-manager-toolbar-icon.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/avd-manager-toolbar-icon.png" alt="figure" title="AVD Manager">
			<ul>
				<li>make sure your AVD uses "Google APIs"
				</li><li>if not, click "pencil" icon to change it
			</li></ul>
	</li></ul>

	<div class="figure">
		<img src="./CS 193A - User Login_files/avd-google-apis.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/avd-google-apis.png" alt="figure">
	</div>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Access key and config file</h1>

	<ul>
		<li>must get <strong>API access key</strong> and <strong>configuration file</strong> for project
		</li><li>go to <a class="popup" href="javascript:if(confirm(%27https://developers.google.com/identity/sign-in/android/  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://developers.google.com/identity/sign-in/android/%27" tppabs="https://developers.google.com/identity/sign-in/android/" target="_blank">https://developers.google.com/identity/sign-in/android/</a>
		</li><li>click "Get Started" &#8594; "Get a Configuration File"
			<ul>
				<li><u>crucial</u>: must set correct <strong>package</strong> (same as in Java code)
				</li><li>e.g. <code>"package <strong><u>edu.stanford.cs193a.logintest</u></strong>;"</code>
			</li></ul>
		</li><li>get an <a class="popup" href="javascript:if(confirm(%27https://developers.google.com/android/guides/client-auth  \n\nThis file was not retrieved by Teleport Pro, because it is addressed using an unsupported protocol (e.g., gopher).  \n\nDo you want to open it from the server?%27))window.location=%27https://developers.google.com/android/guides/client-auth%27" tppabs="https://developers.google.com/android/guides/client-auth" target="_blank">SHA-1 key file</a> (requires using Terminal) :-/
	
	<div class="figure">
		<img src="./CS 193A - User Login_files/google-signin-create-app.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/google-signin-create-app.png" alt="figure">
	</div>
</li></ul></section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Download .json file</h1>
	
	<ul>
		<li>you need to generate/download a file <span class="filename">google-services.json</span>
			<ul>
				<li>Your app sends this to Google's server to get permission to use the API.
			</li></ul>

		</li><li>save it into your app's <span class="filename">app/</span> directory
		</li><li>will not work if in wrong folder or stores wrong app name/package
		</li><li><em>NOTE:</em> be careful storing such a file in GitHub / online (has private keys in it!)
	</li></ul>
	
	<div class="figure">
		<img src="./CS 193A - User Login_files/google-signin-download-json.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/google-signin-download-json.png" alt="figure">
	</div>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Add Google Signin to project</h1>
	
	<ul>
		<li>in <strong>project</strong> level <span class="filename">build.gradle</span> file:
		
		<div class="linenumbersouter"><pre class=" linenumbers"><code style="float: left;">&nbsp;1&nbsp;
&nbsp;2&nbsp;
&nbsp;3&nbsp;</code></pre><pre><code class="groovy hljs">buildscript { ...
    dependencies { ...
        <em>classpath <span class="hljs-string">'com.google.gms:google-services:3.0.0'</span></em>  <span class="hljs-comment">// add this line!</span>
</code></pre></div>

		</li><li>in <strong>app</strong> level <span class="filename">build.gradle</span> file:
		
		<div class="linenumbersouter"><pre class=" linenumbers"><code style="float: left;">&nbsp;1&nbsp;
&nbsp;2&nbsp;
&nbsp;3&nbsp;
&nbsp;4&nbsp;
&nbsp;5&nbsp;
&nbsp;6&nbsp;</code></pre><pre><code class="groovy hljs">dependencies { ...
    <em>compile <span class="hljs-string">'com.google.android.gms:play-services-auth:10.0.1'</span></em>  <span class="hljs-comment">// add this line!</span>
}

<span class="hljs-comment">// put this at the very BOTTOM of the file!</span>
<em>apply <span class="hljs-string">plugin:</span> <span class="hljs-string">'com.google.gms.google-services'</span></em>  <span class="hljs-comment">// add this line!</span>
</code></pre></div>

		</li><li>then "Sync Now"
	</li></ul>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Sign-In button (optional)</h1>
	
	<div class="figuresright">
		<img src="./CS 193A - User Login_files/signin-button-layout.png" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/images/signin-button-layout.png" alt="figure">
	</div>
	
	<div class="linenumbersouter"><pre class=" linenumbers"><code style="float: left;">&nbsp;1&nbsp;
&nbsp;2&nbsp;
&nbsp;3&nbsp;
&nbsp;4&nbsp;
&nbsp;5&nbsp;
&nbsp;6&nbsp;
&nbsp;7&nbsp;
&nbsp;8&nbsp;
&nbsp;9&nbsp;</code></pre><pre><code class="xml hljs"><span class="hljs-comment">&lt;!-- res/layout/activity_?.xml --&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">LinearLayout</span> <span class="hljs-attr">...</span>&gt;</span>

    <em><span class="hljs-tag">&lt;<span class="hljs-name">com.google.android.gms.common.SignInButton</span></span></em><span class="hljs-tag">
        <span class="hljs-attr">android:id</span>=<span class="hljs-string">"@+id/sign_in_button"</span>
        <span class="hljs-attr">android:layout_width</span>=<span class="hljs-string">"wrap_content"</span>
        <span class="hljs-attr">android:layout_height</span>=<span class="hljs-string">"wrap_content"</span> /&gt;</span>

<span class="hljs-tag">&lt;/<span class="hljs-name">LinearLayout</span>&gt;</span>
</code></pre></div>

	<ul>
		<li>Note: Can't listen to events using <code>onClick</code> (must attach in Java code)
	</li></ul>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Initialize Google API</h1>
	
	<div class="linenumbersouter"><pre class=" linenumbers"><code style="float: left;">&nbsp;1&nbsp;
&nbsp;2&nbsp;
&nbsp;3&nbsp;
&nbsp;4&nbsp;
&nbsp;5&nbsp;
&nbsp;6&nbsp;
&nbsp;7&nbsp;
&nbsp;8&nbsp;
&nbsp;9&nbsp;
10&nbsp;
11&nbsp;
12&nbsp;
13&nbsp;
14&nbsp;
15&nbsp;
16&nbsp;
17&nbsp;
18&nbsp;</code></pre><pre><code class="java hljs"><span class="hljs-keyword">private</span> GoogleApiClient google;

<span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onCreate</span><span class="hljs-params">(Bundle savedInstanceState)</span> </span>{
    ...
    <span class="hljs-comment">// request the user's ID, email address, and basic profile</span>
    GoogleSignInOptions options = <span class="hljs-keyword">new</span> GoogleSignInOptions.Builder(
                GoogleSignInOptions.DEFAULT_SIGN_IN)
            .requestEmail()
            .build();

    <span class="hljs-comment">// build API client with access to Sign-In API and options above</span>
    google = <span class="hljs-keyword">new</span> GoogleApiClient.Builder(<span class="hljs-keyword">this</span>)
            .enableAutoManage(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>)
            .addApi(Auth.GOOGLE_SIGN_IN_API, options)
            .addConnectionCallbacks(<span class="hljs-keyword">this</span>)
            .build();
}
</code></pre></div>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Activity events and callbacks</h1>
	
	<ul>
		<li>in order to pass <code>this</code> to API client builder <code>.enableAutoManage</code> call, you must implement some event listening methods in your activity:
	</li></ul>
	
	<div class="linenumbersouter"><pre class=" linenumbers"><code style="float: left;">&nbsp;1&nbsp;
&nbsp;2&nbsp;
&nbsp;3&nbsp;
&nbsp;4&nbsp;
&nbsp;5&nbsp;
&nbsp;6&nbsp;
&nbsp;7&nbsp;
&nbsp;8&nbsp;</code></pre><pre><code class="java hljs"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyActivity</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Activity</span>
        </span><em><span class="hljs-class"><span class="hljs-keyword">implements</span> <span class="hljs-title">GoogleApiClient</span>.<span class="hljs-title">OnConnectionFailedListener</span>,</span></em><span class="hljs-class">
        </span><em><span class="hljs-class"><span class="hljs-title">GoogleApiClient</span>.<span class="hljs-title">ConnectionCallbacks</span></span></em><span class="hljs-class"> </span>{
    ...
    
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConnectionFailed</span><span class="hljs-params">(ConnectionResult connectionResult)</span> </span>{...}
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConnected</span><span class="hljs-params">(Bundle bundle)</span> </span>{...}
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onConnectionSuspended</span><span class="hljs-params">(<span class="hljs-keyword">int</span> i)</span> </span>{...}
</code></pre></div>
</section>

<section hidden="" aria-hidden="true" class="future" style="display: none;">
	<h1>Initiating sign-in process</h1>
	
	<ul>
		<li>to do a login, start an activity using an intent created as follows:
	</li></ul>
	
	<div class="linenumbersouter"><pre class=" linenumbers"><code style="float: left;">&nbsp;1&nbsp;
&nbsp;2&nbsp;</code></pre><pre><code class="java hljs"><span class="hljs-comment">// use this intent to start an activity for a result</span>
Intent signInIntent = Auth.GoogleSignInApi.getSignInIntent(google);
</code></pre></div>

	<ul>
		<li>when the activity returns, examine the result:
	</li></ul>

	<div class="linenumbersouter"><pre class=" linenumbers"><code style="float: left;">&nbsp;1&nbsp;
&nbsp;2&nbsp;
&nbsp;3&nbsp;
&nbsp;4&nbsp;
&nbsp;5&nbsp;
&nbsp;6&nbsp;
&nbsp;7&nbsp;
&nbsp;8&nbsp;
&nbsp;9&nbsp;
10&nbsp;
11&nbsp;</code></pre><pre><code class="java hljs">GoogleSignInResult result =
        Auth.GoogleSignInApi.getSignInResultFromIntent(intent);
<span class="hljs-keyword">if</span> (result.isSuccess()) {
    <span class="hljs-comment">// signed in successfully</span>
    GoogleSignInAccount acct = result.getSignInAccount();
    String username = acct.getDisplayName();
    ...
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// login failed</span>
    ...
}
</code></pre></div>
</section>

<!-- END SLIDES AREA -->
			</div>
		<div class="backgrounds"><div class="slide-background titleslide present" data-loaded="true" style="display: block;"></div><div class="slide-background future" data-loaded="true" style="display: block;"></div><div class="slide-background future" data-loaded="true" style="display: block;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div><div class="slide-background future" style="display: none;"></div></div><div class="progress" style="display: block;"><span style="width: 0px;"></span></div><aside class="controls" style="display: block;"><button class="navigate-left" aria-label="previous slide"></button><button class="navigate-right enabled" aria-label="next slide"></button><button class="navigate-up" aria-label="above slide"></button><button class="navigate-down" aria-label="below slide"></button><button id="fullscreenbutton" title="full-screen mode">&#8862;</button></aside><div class="slide-number" style="display: block;"><span class="slide-number-a">1</span></div><div class="speaker-notes" data-prevent-swipe=""></div><div class="pause-overlay"></div><div id="aria-status-div" aria-live="polite" aria-atomic="true" style="position: absolute; height: 1px; width: 1px; overflow: hidden; clip: rect(1px, 1px, 1px, 1px);">
	CS 193A

	User Login
</div></div>

		<script src="./CS 193A - User Login_files/highlight.pack.js.download" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/highlightjs/highlight.pack.js"></script>
		<script src="./CS 193A - User Login_files/cs193a-slides.js.download" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/cs193a-slides.js"></script>
		<script src="./CS 193A - User Login_files/reveal.js.download" tppabs="http://web.stanford.edu/class/cs193a/lectures/slides/reveal/js/reveal.js"></script>
		<script>
			initializeSlides();
		</script>
	

</body></html>